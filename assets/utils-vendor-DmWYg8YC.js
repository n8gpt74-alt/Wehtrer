var E={exports:{}},Z;function sn(){return Z||(Z=1,(function(_,un){(function(){var b=Math.PI,e=Math.sin,o=Math.cos,q=Math.tan,O=Math.asin,T=Math.atan2,R=Math.acos,d=b/180,I=1e3*60*60*24,U=2440588,j=2451545;function nn(n){return n.valueOf()/I-.5+U}function C(n){return new Date((n+.5-U)*I)}function A(n){return nn(n)-j}var H=d*23.4397;function F(n,t){return T(e(n)*o(H)-q(t)*e(H),o(n))}function k(n,t){return O(e(t)*o(H)+o(t)*e(H)*e(n))}function N(n,t,r){return T(e(n),o(n)*e(t)-q(r)*o(t))}function $(n,t,r){return O(e(t)*e(r)+o(t)*o(r)*o(n))}function B(n,t){return d*(280.16+360.9856235*n)-t}function tn(n){return n<0&&(n=0),2967e-7/Math.tan(n+.00312536/(n+.08901179))}function G(n){return d*(357.5291+.98560028*n)}function K(n){var t=d*(1.9148*e(n)+.02*e(2*n)+3e-4*e(3*n)),r=d*102.9372;return n+t+r+b}function Q(n){var t=G(n),r=K(t);return{dec:k(r,0),ra:F(r,0)}}var h={};h.getPosition=function(n,t,r){var u=d*-r,a=d*t,s=A(n),i=Q(s),c=B(s,u)-i.ra;return{azimuth:N(c,a,i.dec),altitude:$(c,a,i.dec)}};var z=h.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];h.addTime=function(n,t,r){z.push([n,t,r])};var V=9e-4;function rn(n,t){return Math.round(n-V-t/(2*b))}function W(n,t,r){return V+(n+t)/(2*b)+r}function X(n,t,r){return j+n+.0053*e(t)-.0069*e(2*r)}function en(n,t,r){return R((e(n)-e(t)*e(r))/(o(t)*o(r)))}function an(n){return-2.076*Math.sqrt(n)/60}function on(n,t,r,u,a,s,i){var c=en(n,r,u),f=W(c,t,a);return X(f,s,i)}h.getTimes=function(n,t,r,u){u=u||0;var a=d*-r,s=d*t,i=an(u),c=A(n),f=rn(c,a),v=W(0,a,f),g=G(v),w=K(g),P=k(w,0),m=X(v,g,w),x,D,p,M,J,y,l={solarNoon:C(m),nadir:C(m-.5)};for(x=0,D=z.length;x<D;x+=1)p=z[x],M=(p[0]+i)*d,J=on(M,a,s,P,f,g,w),y=m-(J-m),l[p[1]]=C(y),l[p[2]]=C(J);return l};function Y(n){var t=d*(218.316+13.176396*n),r=d*(134.963+13.064993*n),u=d*(93.272+13.22935*n),a=t+d*6.289*e(r),s=d*5.128*e(u),i=385001-20905*o(r);return{ra:F(a,s),dec:k(a,s),dist:i}}h.getMoonPosition=function(n,t,r){var u=d*-r,a=d*t,s=A(n),i=Y(s),c=B(s,u)-i.ra,f=$(c,a,i.dec),v=T(e(c),q(a)*o(i.dec)-e(i.dec)*o(c));return f=f+tn(f),{azimuth:N(c,a,i.dec),altitude:f,distance:i.dist,parallacticAngle:v}},h.getMoonIllumination=function(n){var t=A(n||new Date),r=Q(t),u=Y(t),a=149598e3,s=R(e(r.dec)*e(u.dec)+o(r.dec)*o(u.dec)*o(r.ra-u.ra)),i=T(a*e(s),u.dist-a*o(s)),c=T(o(r.dec)*e(r.ra-u.ra),e(r.dec)*o(u.dec)-o(r.dec)*e(u.dec)*o(r.ra-u.ra));return{fraction:(1+o(i))/2,phase:.5+.5*i*(c<0?-1:1)/Math.PI,angle:c}};function L(n,t){return new Date(n.valueOf()+t*I/24)}h.getMoonTimes=function(n,t,r,u){var a=new Date(n);u?a.setUTCHours(0,0,0,0):a.setHours(0,0,0,0);for(var s=.133*d,i=h.getMoonPosition(a,t,r).altitude-s,c,f,v,g,w,P,m,x,D,p,M,J,y,l=1;l<=24&&(c=h.getMoonPosition(L(a,l),t,r).altitude-s,f=h.getMoonPosition(L(a,l+1),t,r).altitude-s,w=(i+f)/2-c,P=(f-i)/2,m=-P/(2*w),x=(w*m+P)*m+c,D=P*P-4*w*c,p=0,D>=0&&(y=Math.sqrt(D)/(Math.abs(w)*2),M=m-y,J=m+y,Math.abs(M)<=1&&p++,Math.abs(J)<=1&&p++,M<-1&&(M=J)),p===1?i<0?v=l+M:g=l+M:p===2&&(v=l+(x<0?J:M),g=l+(x<0?M:J)),!(v&&g));l+=2)i=f;var S={};return v&&(S.rise=L(a,v)),g&&(S.set=L(a,g)),!v&&!g&&(S[x>0?"alwaysUp":"alwaysDown"]=!0),S},_.exports=h})()})(E)),E.exports}export{sn as r};
